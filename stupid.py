exec("from jina import Flow\nfrom jina.types.document.generators import from_csv\nfrom jinahub.indexers.simple import SimpleIndexer\n\nwith open('data/community_20.csv') as fp:\n    docs = list(from_csv(fp, field_resolver={'title': 'text'}))\n\nflow = (\n    Flow(port_expose=45678, protocol='http')\n    .add(\n        uses='jinahub+docker://TransformerTorchEncoder',\n        name='encoder',\n        override_with={\n            'pretrained_model_name_or_path': 'sentence-transformers/msmarco-distilbert-base-v3'\n        },\n    )\n    .add(\n        uses=SimpleIndexer,\n        name='indexer',\n        override_with={'index_file_name': 'index.json', 'dump_path': 'workspace'},\n    )\n)\nwith flow:\n    flow.post(on='/index', inputs=docs)\n    flow.block()")
